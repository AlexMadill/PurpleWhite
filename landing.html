<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Purple v. White</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      .points-badge {
        display: inline-block;
        min-width: 24px;
        padding: 2px 8px;
        margin-left: 8px;
        border-radius: 999px;
        background: #f0e9ff;
        color: #4b2e83;
        font-weight: 700;
        font-size: 0.85rem;
        border: 1px solid #d8caff;
      }
      .sum-circle {
        margin: 12px auto;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        border: 3px solid #4b2e83;
        background: #f6f1ff;
        color: #4b2e83;
        font-weight: 700;
        font-size: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
  </head>
  <body>
    <nav>
      <h1>Purple v. White</h1>
      <ul>
        <li><a href="#">Home</a></li>
        <li><a href="commonwealth.html">Commonwealth RVA 2025</a></li>
      </ul>
    </nav>

    <main>
      <section class="intro">
        <h2>Welcome to the Competition Hub</h2>

        <div class="box-container">
          <!-- White Team -->
          <div class="team-box">
            <h3>White Team</h3>
            <div class="cup-tag">Commonwealth Cup 2025</div>
            <ul class="roster-list" id="white-roster">
              <li class="white-hl" data-name="Andrew Fulmer">Andrew Fulmer</li>
              <li class="white-hl" data-name="Alana Schneider">
                Alana Schneider
              </li>
              <li class="white-hl" data-name="Kira Schneider">
                Kira Schneider
              </li>
              <li class="white-hl" data-name="Peyton Cossey">Peyton Cossey</li>
              <li class="white-hl" data-name="Evie Metz">Evie Metz</li>
              <li class="white-hl" data-name="James Kreel">James Kreel</li>
              <li class="white-hl" data-name="Blake Zimmermann">
                Blake Zimmermann
              </li>
              <li class="white-hl" data-name="James Davis">James Davis</li>
            </ul>
            <div class="sum-circle" id="white-sum">0</div>

            <ul class="roster-list">
              <li class="spacer"></li>
              <div class="cup-tag">MOR Atlantic 2025</div>

              <li data-name="Keenan Olson">Keenan Olson</li>
              <li data-name="Hailey Mizell">Hailey Mizell</li>
              <li data-name="London Bates">London Bates</li>
              <li data-name="Ellie Crosby">Ellie Crosby</li>
              <li data-name="Bennett White">Bennett White</li>
              <li data-name="Miles Ayres">Miles Ayres</li>
              <li data-name="Brady Houtz">Brady Houtz</li>
              <li data-name="Brooklyn Green">Brooklyn Green</li>
              <li data-name="Haley Houtz">Haley Houtz</li>
              <li data-name="Brian Lee">Brian Lee</li>
              <li data-name="Esther Lee">Esther Lee</li>
            </ul>
          </div>

          <!-- Purple Team -->
          <div class="team-box">
            <h3>Purple Team</h3>
            <div class="cup-tag">Commonwealth Cup 2025</div>
            <ul class="roster-list" id="purple-roster">
              <li class="purple-hl" data-name="Katie Wilson">Katie Wilson</li>
              <li class="purple-hl" data-name="Kaitlyn Davis">Kaitlyn Davis</li>
              <li class="purple-hl" data-name="Aubrey Lewis">Aubrey Lewis</li>
              <li class="purple-hl" data-name="Alannah Keough">
                Alannah Keough
              </li>
              <li class="purple-hl" data-name="McKaleigh Keough">
                McKaleigh Keough
              </li>
              <li class="purple-hl" data-name="Porter Anderson">
                Porter Anderson
              </li>
              <li class="purple-hl" data-name="Peyton Womble">Peyton Womble</li>
              <li class="purple-hl" data-name="Emilio Perez">Emilio Perez</li>
            </ul>
            <div class="sum-circle" id="purple-sum">0</div>

            <ul class="roster-list">
              <li class="spacer"></li>
              <div class="cup-tag">MOR Atlantic 2025</div>

              <li data-name="Everett Crosby">Everett Crosby</li>
              <li data-name="Tate Jewett">Tate Jewett</li>
              <li data-name="Ellis Carroll">Ellis Carroll</li>
              <li data-name="Michael White">Michael White</li>
              <li data-name="Chance Harper">Chance Harper</li>
              <li data-name="Anna Muttillo">Anna Muttillo</li>
              <li data-name="Emma Tadd">Emma Tadd</li>
              <li data-name="Laura Soliman">Laura Soliman</li>
              <li data-name="Diana Burke">Diana Burke</li>
              <li data-name="Mattie Gollings">Mattie Gollings</li>
              <li data-name="Ally White">Ally White</li>
            </ul>
          </div>
        </div>

        <div class="meets-container">
          <a href="commonwealth.html" class="meet-box">
            <h4>Commonwealth RVA 2025</h4>
          </a>
          <div class="meet-box"><h4>MOR Atlantic 2025</h4></div>
          <div class="meet-box"><h4>Turkey Classic 2025</h4></div>
        </div>
      </section>
    </main>

    <script>
      function getTotalPointsForSwimmer(swimmerName) {
        let total = 0;
        const suffix = "__" + swimmerName + "_points";
        for (let i = 0; i < localStorage.length; i++) {
          const k = localStorage.key(i);
          if (!k) continue;
          if (k.endsWith(suffix)) {
            const v = parseInt(localStorage.getItem(k), 10);
            if (!isNaN(v)) total += v;
          }
        }
        return total;
      }

      function renderPointsAndSums() {
        document
          .querySelectorAll(".roster-list li[data-name]")
          .forEach((li) => {
            const name = li.dataset.name?.trim();
            if (!name) return;
            const old = li.querySelector(".points-badge");
            if (old) old.remove();

            const total = getTotalPointsForSwimmer(name);
            const badge = document.createElement("span");
            badge.className = "points-badge";
            badge.textContent = total;
            li.appendChild(badge);
          });

        // Sum top 8 (Commonwealth swimmers)
        const whiteNames = Array.from(
          document.querySelectorAll("#white-roster li.white-hl")
        )
          .slice(0, 8)
          .map((li) => li.dataset.name);
        const purpleNames = Array.from(
          document.querySelectorAll("#purple-roster li.purple-hl")
        )
          .slice(0, 8)
          .map((li) => li.dataset.name);

        const whiteSum = whiteNames.reduce(
          (a, n) => a + getTotalPointsForSwimmer(n),
          0
        );
        const purpleSum = purpleNames.reduce(
          (a, n) => a + getTotalPointsForSwimmer(n),
          0
        );

        document.getElementById("white-sum").textContent = whiteSum;
        document.getElementById("purple-sum").textContent = purpleSum;
      }

      renderPointsAndSums();

      window.addEventListener("storage", (e) => {
        if (e.key && e.key.endsWith("_points")) renderPointsAndSums();
      });
    </script>
  </body>
</html>
